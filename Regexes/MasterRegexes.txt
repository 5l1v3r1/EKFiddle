## Regular expressions master list created from public sources.
############################# WARNING!!!! ####################################
## Do not edit this file, use CustomRegexes.txt for your own regexes instead
## or else your changes will be lost.
##############################################################################
## To report false positives, or contribute: https://twitter.com/EKFiddle
## Last updated: 2018-12-18

## Malvertising / redirection chains
URI	Fobos Campaign	\.(info|biz)\/\w{3,15}\/index\.php\?([a-z]{1,2}=1&)?s=[0-9]{8,12}\?$	https://www.malwarebytes.com/pdf/white-papers/CybercrimeTacticsAndTechniques-Q2-2017.pdf
URI	HookAds Campaign	\.info\/\?(activer|maven|cash)(-[a-z]{2,4}|)&source=	https://blog.malwarebytes.com/cybercrime/exploits/2016/11/the-hookads-malvertising-campaign/
URI	Examhome Campaign	examhome\.net|mp3menu\.org|ads\.voipnewswire\.net|cdn\.allyouwant\.online	http://labs.sucuri.net/?note=2018-09-18
URI	Fake wp.org	www\.(?![a-z]+\.)[a-zA-Z0-9]{2}wp\.org\/jquery\.js	https://labs.sucuri.net/?note=2018-10-30
URI	PopCash Redirection	\.club\/B3Lhcr\?	https://traffic.moe/2018/04/10/index2.html
URI	Hacked Site (redirect)	\/(\w{4}|\w{8})\/(\w{5}|\w{9})\.php\?([a-z]{6}|[a-z]{3})=[\w']{1,25}-[\w']{1,25}
URI	FakeUpdates Redirection	\/jquery\?frm=script&se_referrer=
URI	Saskmade Campaign	saskmade\.net\/|rnewsr\.com\/	https://blog.sucuri.net/2018/10/saskmade-net-redirects.html
URI	Seamless Pre-gate	^https?:\/\/redirect\.distan-kenques\.com\/redirect\?target=BASE64[\w&=_-]+&rm=D	https://traffic.moe/2018/01/25/index.html
URI	Seamless Gate Campaign	^https?:\/\/(xn--[\w\.-]+|[a-z0-9]+\.info|(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3})\/gav[0-9]\.php	https://umbrella.cisco.com/blog/2017/03/29/seamless-campaign-delivers-ramnit-via-rig-ek/
URI	Slyip Campaign	\.slyip[.](com|net)\/(y2mate\/|[a-zA-Z0-9]{6}\?|index\.php\?)browser=	https://twitter.com/EKFiddle/status/994974656133189633
URI	TK Crypper Redir.	\.tk\/index\/\?[0-9]{13}$|js\.localstorage\.tk\/|\.tk\/\?number=[0-9-]{12,14}
URI	WP-GDPR Hack	myspaceid\.space\/
SourceCode	WP-GDPR Hack	0x6d,0x79,0x73,0x70,0x61,0x63,0x65,0x69,0x64,0x2e,0x73,0x70,0x61,0x63,0x65
SourceCode	Baidu Redirect	;this\.removeEventListener\('click',arguments\.callee,false\)\}\)\}\};
SourceCode	RIG iframe injection	document\.write\('\\<script type=\\'text\/javascript\\'\\>location = \\'http:\/\/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}\/	https://twitter.com/nao_sec/status/970689970552815616
SourceCode	Compromised WordPress (Examhome)	eval\(String.fromCharCode\(118,97,114,32,115,111,109,101,115,116|script src='https:\/\/(cdn.examhome\.net|ads.voipnewswire\.net|cdn.allyouwant\.online)	https://blog.malwarebytes.com/threat-analysis/2018/09/mass-wordpress-compromises-tech-support-scams/
SourceCode	Compromised WordPress (Saskmade)	<script src='https:\/\/saskmade\.net\/head
SourceCode	Compromised site (FakeUpdates)	\/jquery\?frm=script&se_referrer=	https://twitter.com/Ring0x0/status/976613052606046208
SourceCode	FlashOffer	iframe src="http:\/\/'\+window\.location\.hostname\+'\/lp\/flash\/offer\.php	https://traffic.moe/2018/03/15/index.html
SourceCode	Fobos Campaign	if\(ewe?id<0\) \{alert \([a-z]{3,5}\)\};var wt = '[0-9]'; scc = document
SourceCode	HookAds Campaign	 {3}[A-Z][a-z]{3,10} \+= browsrObj\.browser\+'-'\+browsrObj.browser_real
SourceCode	Fake jQuery Campaign	\\x73\\x6A\\x2E\\x79\\x72\\x65\\x75\\x71\\x6A\\x2	https://blog.sucuri.net/2017/04/wordpress-security-unwanted-redirects-via-infected-javascript-files.html
SourceCode	Popuplink (Fake Plugin redir)	"url":"http:\\\/\\\/tiny\.cc	https://blog.sucuri.net/2018/08/fake-plugins-with-popuplink-js-redirect-to-scam-sites.html
SourceCode	Compromised site (PropellerAds injection)	apu\.php\?zoneid=783225	https://twitter.com/unmaskparasites/status/1034492351484440577
SourceCode	Compromised site (TSS redir)	content="0; URL=http:\/\/[a-z0-9]{2,15}\.xcacherdie\.stream">
SourceCode	PropellerAds injection	src="\/\/((go\.(oclasrv|mobtrks|mobisla))|defpush)\.com\/(notice|apu|ntfc)\.php\?(p|zoneid)=[0-9]{7}
SourceCode	Seamless Pre-gate	append\("body"\).html\("<div style=\\"\\"><\/div>"\);window.location.href = "http:\/\/treculty-porditely
SourceCode	TSS redirect	<meta http-equiv="refresh" content="0; URL=http:\/\/([a-z0-9]{2,25}\.){2}(info|stream)"> <\/p>	https://twitter.com/unmaskparasites/status/1041753812518617088
SourceCode	iframe to RIG EK	(\t| )<iframe (width="500" scrolling="no" height="500" frameborder="500")?src="http:\/\/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}\/\?(.+<\/iframe>  )?	https://traffic.moe/2018/03/27/index.html
SourceCode	Shoppers TSS Redirection	<li><a href="men-shop\.php">	https://blog.malwarebytes.com/threat-analysis/2018/05/shoppers-stop-tech-scam-draws-thousands-forced-ad-injections/
IP	Etags/Coins LTD	137\.74\.159\.216
IP	FakeUpdates	185\.243\.112\.38|45\.32\.52\.31
IP	HookAds Campaign	88\.208\.7\.193
IP	Mining and redirects	5\.45\.79\.15
Headers	CPM20 injection Campaign	cpm20\.com
Headers	Crypper Campaign	00831=%7B
Headers	Malcdn Campaign	9d5e3=eyJ

## Exploit Kits / Drive-by downloads
URI	GrandSoft EK	\.(tk|xyz|info)\/([0-9]\/[0-9]{3,6}|dwie\.hta|getversoinpd\/1\/2\/3\/4)$	https://twitter.com/kafeine/status/958298409944920064
URI	KaiXin EK	^http(s|):\/\/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}\/([A-Z][a-z]){3}\.(html|jar)$
URI	Magnigate/Magnitude EK	^http:\/\/(?=(.*\d){4})(?=.*[a-zA-Z])[0-9a-zA-Z!@#$%]{8,}\.[a-z]{6,7}\.(?!com)[a-z]{4,15}\/$	https://malware.dontneedcoffee.com/2018/03/CVE-2018-4878.html
URI	RIG EK	^https?:\/\/[^\x3f]+\/\x3f[^\x3f]+Q[cdM][_fPrv][bDfLPTWX][acdefYZVU][abKLJ][^\n]+$	https://twitter.com/baberpervez2
URI	CVE-2018-4878 Artifact	individualization\.adobe\.com\/(crossdomain\.xml|flashaccess\/i15n\/v5)$
URI	Underminer EK	\/(rt|js)\/(?=(.*\d){4})[a-z0-9]{26}\.(html|swf|js|wasm)$	https://blog.malwarebytes.com/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/
URI	Underminer EK	(\/servlets\/CSPms\.dll\?token=&id=[0-9]{5}&validate|\/article.asp\?id)=[a-z0-9]{32}$
SourceCode	Fallout EK	>try\{window\.screen\.width<=1024&&window\.screen\.height<=768	https://lists.emergingthreats.net/pipermail/emerging-sigs/2018-August/028932.html
SourceCode	GrandSoft EK	(document\.write\("<iframe src='"\+srcOfScript\+"'><\/iframe>"\);<\/script>|trifix = zerofix & zerofix & zerofix)	https://twitter.com/kafeine/status/958298409944920064
SourceCode	KaiXin EK	;[a-z] [a-z0-9]{2}=new [a-z]\["\\\\[a-z]\\\\[a-z]\\\\[a-z]\\\\[a-z]\\\\x79"\]
SourceCode	Underminer EK	src="\/js\/(?=(.*\d){4})[a-z0-9]{26}\.js"><\/script>|TinyJSLibrary\.enc\.Hex\.parse\('[a-z0-9]{32}'\)\)\.toString\(TinyJSLibrary\.enc\.Utf8\)\);
SourceCode	CVE-2016-0189	return String.fromCharCode\(x & 0xffff\) \+ String.fromCharCode\(x >> 16\);	https://github.com/theori-io/cve-2016-0189
SourceCode	CVE-2018-8174	Dim (IIIlI|arr1)\(6\),(IllII|arr2)\(6\)	https://www.exploit-db.com/exploits/44741/
SourceCode	CVE-2018-8373	ReDim Preserve array\(100000\)|\(index_vul\)\(index_a,0\)="AAAA"
IP	GrandSoft EK	185\.246\.153\.229
IP	KaiXin EK	59\.11\.209\.157
Headers	Redirection to RIG EK	https?:\/\/[^\x3f]+\/\x3f[^\x3f]+Q[cdM][_fPrv][bDfLPTWX][acdefYZ][abKLJ][^\n]+
Headers	GreenFlash Sundown EK	5a0c76d6-117

## Web Miners / Drive-by mining
URI	Coin Have	coin-have\.com\/
URI	Coinhive	^https:\/\/((cnhv\.co|coin-?hive\.com)|ws[0-9]{1,3}\.coinhive\.com\/proxy)
URI	CoinIMP Web Miner	hashing\.win\/|pastebin\.com\/raw\/VXm4051W|\.\w+\.\/\w{4}\.js$
URI	Crypto-Loot	crypto-?loot\.(com|pro)\/|minr\.pw\/|cryptaloot\.pro\/
URI	DeepMiner	\/deepMiner.js$
URI	CoinIMP (wasm)	\.\/\w+\.wasm$	https://blog.sucuri.net/2018/07/coinimp-cryptominer-and-fully-qualified-domain-names.html
URI	CoinIMP (proxy)	\.\/proxy2?$
URI	Drive-by Mining (Nulled WP)	\/assets\/js\/jquory\.js	http://labs.sucuri.net/?note=2018-06-05
URI	JSE-Coin	(load.)?jsecoin\.com\/
URI	Web Miner (CoinIMP)	drupalupdates\.tk\/
URI	Web Miner	\/vbb\/me0w.js|allfontshere.press\/fonts\/|eth-pocket\.(com|de|eu):8585|cryptaloot\.pro\/|siteverification\.online\/lib\/info\.js|uoldid\.ru|omine\.ga\/|upgraderservices\.cf\/
URI	Web Miner (Mineralt)	dinorslick\.icu\/
URI	Web Miner (PPoi)	ppoi\.org\/lib\/miner\.min\.js
URI	Web Miner (recaptcha backdoor)	recaptcha-in\.pw\/	http://labs.sucuri.net/?details=portal-d.pw
SourceCode	AuthedMine	<script src="https:\/\/authedmine.com
SourceCode	Coinhive	\[\["wss:\/\/ws[0-9]{1,3}\.coinhive\.com\/proxy",
SourceCode	Drive-by Mining	\/js(-lib)?\/smmch-(own|mine)\.js|webmining\.co\/lib\/wm\.js|\/lib\/((coinhive|miner).min.js|(',')?justdoit2\.js)|src="\/\/uoldid\.ru\/[0-9]{10}|bayimg\.com\/image\/hahnoaacl.jpg|src=("|')https:\/\/(cnhv\.co|omine\.ga)\/|iframe src="http:\/\/adalso\.com\/ad\/|dogeminers\.com\/lite.php	https://blog.malwarebytes.com/threat-analysis/2017/09/drive-by-mining-and-ads-the-wild-wild-west/
SourceCode	Drive-by Mining (adfrend)	46,97,100,102,114,101,110,100,46,99,111,109,47
SourceCode	Drive-by Mining (Hex)	\\x68\\x74\\x74\\x70\\x73\\x3A\\x2F\\x2F\\x63\\x6F\\x69\\x6E\\x68\\x69\\x76\\x65\\x2E\\x63\\x6F\\x6D\\x2F\\x6C\\x69\\x62\\x2F
SourceCode	Drive-by Mining (cnhv obf.)	%63%6e%68%76%2e%63%6f
SourceCode	Drive-by Mining (Coinhive)	miner = new (CoinHive|CRLT)\.(Anonymous|User)\('
SourceCode	Drive-by Mining (Coinhive obf.)	\|miner\|User\|CoinHive\|\|
SourceCode	Drive-by Mining (coin-hive obf.)	%3D%43%6F%69%6E%48%69%76%65%2E%41%6E%6F%6E%79%6D%6F%75%73%2
SourceCode	Drive-by Mining (CoinIMP)	<script src="https:\/\/(www)?\.\w+\.\w+\.\/|hostingcloud\.(science|racing)\/|hashing\.win\/
SourceCode	Drive-by Mining (Crypto-Loot)	\\x77\\x73\\x73\\x3a\\x2f\\x2f\\x6f\\x63\\x65\\x61\\x6e\\x32\\x2e\\x64\\x69\\x72\\x65\\x63\\x74\\x70\\x72\\x69\\x6d\\x61\\x6c\\x2e\\x63\\x6f\\x6d
SourceCode	Cryptomining (JSE-Coin)	= ?('|")https:\/\/load\.jsecoin\.com\/(server\/)?load\/[0-9]{4,6}\/
SourceCode	Drive-by Mining (Coin Have)	<script src="https:\/\/coin-have\.com\/c\/
SourceCode	Drive-by Mining (Nulled WP)	\/assets\/js\/jquory\.js
SourceCode	Drive-by Mining (Mineralt)	\\x52\\x32\\x4E\\x34\\x54\\x55\\x77\\x7A\\x52\\x6C\\x6F\\x37|WDFEY2R1clI7LTUwOzE|dinorslick\.icu\/	https://twitter.com/unmaskparasites/status/1017028395941625856
SourceCode	Drive-by Mining (RawGit)	cdn.rawgit\.com\/jdobt	https://blog.sucuri.net/2018/07/rawgit-cdn-is-abused-by-cryptoloot-cryptominers.html
SourceCode	Drive-by Mining (recaptcha redir)	src="http:\/\/recaptcha-in\.pw
SourceCode	Drive-by Mining (streaming)	cdn.akubebas.com\/js\/ch_new.js"
SourceCode	Drive-by Mining (Drupal)	src="https:\/\/windworld.org\/vbb\/me0w.js"|var [a-zA-Z]{2,8}1= ?window\["\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74"\]|src="\/\/(upgraderservices\.cf|drupalupdates\.tk)	https://www.incapsula.com/blog/crypto-me0wing-attacks-kitty-cashes-in-on-monero.html
SourceCode	Encoded wasm (possible web miner)	IE1vZHVsZT17fTtNb2R1bGVbIndhc21CaW5hcnkiXT
SourceCode	vBulletin Drive-by Mining	<script async="async" src="http:\/\/allfontshere.press
SourceCode	Web Miner	\|\| [a-z]; this._useWASM=this.hasWASMSupport\(\) && !a.forceASMJS;
SourceCode	DeepMiner	\/deepMiner.js|= new deepMiner.Anonymous\(uri,

## Social Engineering / Tech Support Scams
URI	FakeUpdates	\/([a-z0-9]{70}|s_code\.js)\?cid=[0-9]{3}&(session=[a-z0-9]{32}|v=[a-z0-9]{20})	http://www.broadanalysis.com/2018/03/03/fake-flash-and-chrome-updates-lead-to-ramnit-trojan/
URI	FlashOffer	\/lp\/flash\/offer\.php$	https://traffic.moe/2018/03/15/index.html
URI	FakeAdobeFlash	^https?:\/\/[^\x3f]+\/(\x3f(dfgh=|pcl=|51tga=)|(zzz\x3f))[^\x3f]+(&cid=|&sid=)[^\n]+$|\x3f[^\x3f]+(..&cid=)?[^\x3f]+(&(sid|SUB_ID|sub|payout)=)[^\x3f]+(&v_id=)[^\x3f]+$	https://twitter.com/baberpervez2
URI	FakeUpdates (DropBox)	^https\:\/\/dl\.dropboxusercontent\.com\/s\/[\w\d]{15}\/[^\x3f]+\.js\?dl\=1	https://twitter.com/baberpervez2
URI	TSS Browlock	\/((\?number=|(AT-|)TollFree(-|))((1-)?8[0-9]{2}-[0-9]{3}-[0-9]{4}|([0-9]{2}-){4}[0-9]{2}&)|\?a=[0-9]{4}&source=[0-9]{5}_[0-9]{5})$
URI	TSS Forced login	\.club\/newauth\/\w+\/auth.php$
SourceCode	EITest	function FPGo\(\)
SourceCode	Shoppers TSS Campaign	Your computer with the IP address <strong>182.74.27.50
SourceCode	TSS PartnerStroka Campaign	var stroka = "<tr><td valign
SourceCode	FakeFlash	alert\("WARNING! Your Flash Player is out of date\. |src="http:\/\/byte\.wo\.tc\/js\/lib\/js\.js">
SourceCode	FakeUpdates Redirection	&t3n2elg,A\{r\}efs\)u8|function [a-z]\([a-z]\)\{var [a-z]='';for\(var [a-z]=[a-z].length-1;[a-z]>=0;[a-z]--\){[a-z]\+=[a-z]\[[a-z]\];}return [a-z];\}\}\)\(\);	https://blog.malwarebytes.com/threat-analysis/2018/04/fakeupdates-campaign-leverages-multiple-website-platforms/
SourceCode	TSS Browlock	\\nToll Free: \(888\) [0-9]{3}-[0-9]{4}(\\n){20}|if \([0-9]{1,3} == a\.keyCode( \|\| [0-9]{1,3} == a\.keyCode){9}\) return !1|Hard Drive [sS]afety [dD]elete (in )?[sS]tarting [iI]n <span
SourceCode	TK TSS redirection	<script>window.location.replace\("http:\/\/[a-z-]{3,20}\.tk\/index\/\?[0-9]{13}"\);
SourceCode	TSS (forced login)	<iframe height="1" src="login.php|ifr\.src = 'https?:\/\/\w+\.club\/newauth\/\w+\/auth.php
SourceCode	TSS TFN	(\+1)?(-[0-9]{3}){2}-[0-9]{4}(\\n){30}
SourceCode	TSS redirection	function createCookie13123213\(e,o,r\)
SourceCode	TSS warning audio	(beep|alert|warning|Texts|assests\/eng)[0-9]?\.mp3" type="audio

## CC and other Stealers
URI	Magecart (skimmer)	(bootstrap-js|g-statistic)\.com\/	https://blog.malwarebytes.com/threat-analysis/2018/11/web-skimmers-compete-umbro-brasil-hack/
URI	Magecart (C2)	magento\.name\/|onlineclouds\.cloud\/	http://www.broadanalysis.com/2018/09/19/magecart-appears-to-have-targeted-another-online-retailer/
URI	Web Skimmer	magentocore\.net\/
SourceCode	Compromised site (Magecart)	src='https:\/\/magento.name\/
SourceCode	Magecart (code)	\\x2C\\x62\\x75\\x74\\x74\\x6F\\x6E\\x2C\\x20\\x69\\x6E\\x70\\x75\\x74\\x2C\\x20\\x73\\x75\\x62\\x6D\\x69\\x74\\x2C	https://www.riskiq.com/blog/labs/magecart-ticketmaster-breach/
SourceCode	JS Sniffer	gas\.src=location\.protocol\+'\/\/|L2dhdGUucGhw"\)\+"\?image_id=	https://www.volexity.com/blog/2018/07/19/js-sniffer-e-commerce-data-theft-made-easy/
SourceCode	Web Skimmer (Magento)	src='https:\/\/magentocore\.net\/	https://twitter.com/gwillem/status/1034061889381253122
URI	JS Sniffer	=WyJ1cmwl

## Phishing
SourceCode	Chalbhai Phish	name=chalbhai id=chalbhai method=post

## C2 Callbacks


## END OF REGEXES ##
