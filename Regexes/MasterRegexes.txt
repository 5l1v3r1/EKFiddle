## Regular expressions master list created from public sources.
############################# WARNING!!!! ####################################
## Do not edit this file, use CustomRegexes.txt for your own regexes instead
## or else your changes will be lost.
##############################################################################
## To report false positives, or contribute: https://twitter.com/EKFiddle
## Last updated: 2019-05-12

## Malvertising / redirection chains
URI	Fobos Campaign	\.(info|biz)\/\w{3,15}\/index\.php\?([a-z]{1,2}=1&)?s=[0-9]{8,12}\?$	https://www.malwarebytes.com/pdf/white-papers/CybercrimeTacticsAndTechniques-Q2-2017.pdf
URI	HookAds Campaign	\.info\/\?(activer|maven|cash)(-[a-z]{2,4}|)&source=	https://blog.malwarebytes.com/cybercrime/exploits/2016/11/the-hookads-malvertising-campaign/
URI	Examhome Campaign	examhome\.net|mp3menu\.org|ads\.voipnewswire\.net|cdn\.allyouwant\.online	http://labs.sucuri.net/?note=2018-09-18
URI	FakeUpdates Redirection	\/jquery\?frm=script&se_referrer=
URI	PseudoGate	traiding\.today\/
URI	Saskmade Campaign	saskmade\.net\/|rnewsr\.com\/	https://blog.sucuri.net/2018/10/saskmade-net-redirects.html
URI	TK Redirect	\.tk\/index\/\?[0-9]{13}$|js\.localstorage\.tk\/|\.tk\/\?number=[0-9-]{12,14}
SourceCode	Baidu Redirect	;this\.removeEventListener\('click',arguments\.callee,false\)\}\)\}\};
SourceCode	RIG iframe injection	document\.write\('\\<script type=\\'text\/javascript\\'\\>location = \\'http:\/\/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}\/	https://twitter.com/nao_sec/status/970689970552815616
SourceCode	Compromised WordPress (Examhome)	eval\(String.fromCharCode\(118,97,114,32,115,111,109,101,115,116|script src='https:\/\/(cdn.examhome\.net|ads.voipnewswire\.net|cdn.allyouwant\.online)	https://blog.malwarebytes.com/threat-analysis/2018/09/mass-wordpress-compromises-tech-support-scams/
SourceCode	Compromised WordPress (Saskmade)	<script src='https:\/\/saskmade\.net\/head
SourceCode	Compromised site (FakeUpdates)	\/jquery\?frm=script&se_referrer=	https://twitter.com/Ring0x0/status/976613052606046208
SourceCode	FlashOffer	iframe src="http:\/\/'\+window\.location\.hostname\+'\/lp\/flash\/offer\.php	https://traffic.moe/2018/03/15/index.html
SourceCode	Fobos Campaign	    dt\.write\('rame frameborder=0 id="' \+ eweid \+
SourceCode	HookAds (1st step)	<img id="img-top" src="AAA" alt="">
SourceCode	HookAds (2nd step)	window\[\'\w+cript'\]\);\r\nString
SourceCode	Fake jQuery Campaign	\\x73\\x6A\\x2E\\x79\\x72\\x65\\x75\\x71\\x6A\\x2	https://blog.sucuri.net/2017/04/wordpress-security-unwanted-redirects-via-infected-javascript-files.html
SourceCode	TK Redirect	var x = asdasq3hgvb\('pp0000011'\);|<meta http-equiv="refresh" content="0; URL=http:\/\/([a-z0-9]{2,25}\.){2}(info|stream)"> <\/p>	https://twitter.com/unmaskparasites/status/1041753812518617088
SourceCode	SocialWarfare Campaign	"\\x73\\x6C\\x69\\x63\\x65","\\x30\\x30"	https://blog.sucuri.net/2019/03/zero-day-stored-xss-in-social-warfare.html
SourceCode	iframe to RIG EK	(\t| )<iframe (width="500" scrolling="no" height="500" frameborder="500")?src="http:\/\/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}\/\?(.+<\/iframe>  )?	https://traffic.moe/2018/03/27/index.html
SourceCode	Shoppers TSS Redirection	<li><a href="men-shop\.php">	https://blog.malwarebytes.com/threat-analysis/2018/05/shoppers-stop-tech-scam-draws-thousands-forced-ad-injections/
IP	Casting_IQoption Campaign	178\.128\.155\.191|45\.55\.107\.240	https://twitter.com/kafeine/status/1092000556598677504
IP	Etags/Coins LTD	137\.74\.159\.216
IP	FakeUpdates	185\.243\.112\.38|45\.32\.52\.31
IP	HookAds Campaign	88\.208\.7\.19(3|2)
IP	Mining and redirects	5\.45\.79\.15
Headers	Crypper Campaign	00831=%7B
Headers	Malcdn Campaign	9d5e3=eyJ

## Exploit Kits / Drive-by downloads
URI	GrandSoft EK	\.(tk|xyz|info|space|website|site|host)\/(9\/[0-9]{5,7}|dwie\.hta|getversoinpd\/1\/2\/3\/4)$	https://twitter.com/kafeine/status/958298409944920064
URI	KaiXin EK	^http(s|):\/\/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}\/([A-Z][a-z]){3}\.(html|jar)$
URI	Magnigate/Magnitude EK	^http:\/\/(?=(.*\d){4})(?=.*[a-zA-Z])[0-9a-zA-Z!@#$%]{8,}\.[a-z]{6,7}\.(?!com)[a-z]{3,15}\/$	https://malware.dontneedcoffee.com/2018/03/CVE-2018-4878.html
URI	RIG EK	^https?:\/\/[^\x3f]+\/\x3f[^\x3f]+Q[cdM][_fPrv][bDfLPTWXjn][acdefYZVUb][abKLJ][^\n]+$	https://twitter.com/baberpervez2
URI	CVE-2018-4878 Artifact	individualization\.adobe\.com\/(crossdomain\.xml|flashaccess\/i15n\/v5)$
URI	Router EK	^http:\/\/192.168.0.1\/(userRpm\/|cgi-bin\/prim|form2Wan|form2Dhcpd)	https://twitter.com/david_jursa/status/1111311144642404352
URI	Spelevo EK	^https?:\/\/(?!www)[^.]([a-z0-9]+\.){2}(xyz|top|icu)\/(\?\w+[xcb]&|[a-z]{3,15}(-[a-z]{3,15}){2}\/\?)id=\w{21}(&00000111&11)?$	https://twitter.com/kafeine/status/1103649040800145409
URI	Underminer EK	\/(rt|js)\/(?=(.*\d){4})[a-z0-9]{26}\.(html|swf|js|wasm)$	https://blog.malwarebytes.com/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/
URI	Underminer EK	(\/servlets\/CSPms\.dll\?token=&id=[0-9]{5}&validate|\/article.asp\?id)=[a-z0-9]{32}$
SourceCode	Fallout EK	[Il1]{4,20}\['[Il1]{4,20}'\] = '@@'\['[Il1]{4,20}']\(\);
SourceCode	GrandSoft EK	(document\.write\("<iframe src='"\+srcOfScript\+"'><\/iframe>"\);<\/script>|trifix = zerofix & zerofix & zerofix)	https://twitter.com/kafeine/status/958298409944920064
SourceCode	KaiXin EK	;[a-z] [a-z0-9]{2}=new [a-z]\["\\\\[a-z]\\\\[a-z]\\\\[a-z]\\\\[a-z]\\\\x79"\]
SourceCode	Router EK	%31%39%32%2E%31%36%38%2E%30%2E%31%|MTkyLjE2OC4wLjE=|MTAuMC4wLjE=
SourceCode	Spelevo EK	while\(l>=8\)\{r\+=w\(\(b>>>\(l-=8\)\)%256\);\}
SourceCode	Underminer EK	src="\/js\/(?=(.*\d){4})[a-z0-9]{26}\.js"><\/script>|TinyJSLibrary\.enc\.Hex\.parse\('[a-z0-9]{32}'\)\)\.toString\(TinyJSLibrary\.enc\.Utf8\)\);
SourceCode	CVE-2016-0189	return String.fromCharCode\(x & 0xffff\) \+ String.fromCharCode\(x >> 16\);	https://github.com/theori-io/cve-2016-0189
SourceCode	CVE-2018-8174	Dim (IIIlI|arr1)\(6\),(IllII|arr2)\(6\)	https://www.exploit-db.com/exploits/44741/
SourceCode	CVE-2018-8373	ReDim Preserve array\(100000\)|\(index_vul\)\(index_a,0\)="AAAA"
IP	GrandSoft EK	212\.109\.198\.232
IP	KaiXin EK	43\.255\.29\.37|183\.2\.242\.171
IP	Spelevo EK	95\.211\.27\.149|95\.211\.15\.181
Headers	Redirection to RIG EK	https?:\/\/[^\x3f]+\/\x3f[^\x3f]+Q[cdM][_fPrv][bDfLPTWX][acdefYZ][abKLJ][^\n]+
Headers	GreenFlash Sundown EK	5a0c76d6-117

## Web Miners / Drive-by mining
URI	Coinhive	^https:\/\/((cnhv\.co|coin-?hive\.com)|ws[0-9]{1,3}\.coinhive\.com\/proxy)
URI	CryptoLoot	crypto-?loot\.(com|pro)\/|minr\.pw\/|cryptaloot\.pro\/|statdynamic\.com
URI	CoinIMP (wasm)	\.\/\w+\.wasm$	https://blog.sucuri.net/2018/07/coinimp-cryptominer-and-fully-qualified-domain-names.html
URI	CoinIMP (proxy)	\.\/proxy2?$
SourceCode	Coin Miner	var client=new Client.Anonymous
SourceCode	CryptoLoot	function\(\)\{miner\['\\x5f\\x65\\x6d\\x69\\x74'\]
SourceCode	Drive-by Mining	\/js(-lib)?\/smmch-(own|mine)\.js|webmining\.co\/lib\/wm\.js|\/lib\/((coinhive|miner).min.js|(',')?justdoit2\.js)|src="\/\/uoldid\.ru\/[0-9]{10}|bayimg\.com\/image\/hahnoaacl.jpg|src=("|')https:\/\/(cnhv\.co|omine\.ga)\/|iframe src="http:\/\/adalso\.com\/ad\/|dogeminers\.com\/lite.php	https://blog.malwarebytes.com/threat-analysis/2017/09/drive-by-mining-and-ads-the-wild-wild-west/
SourceCode	Drive-by Mining (Hex)	\\x68\\x74\\x74\\x70\\x73\\x3A\\x2F\\x2F\\x63\\x6F\\x69\\x6E\\x68\\x69\\x76\\x65\\x2E\\x63\\x6F\\x6D\\x2F\\x6C\\x69\\x62\\x2F
SourceCode	Drive-by Mining (cnhv obf.)	%63%6e%68%76%2e%63%6f
SourceCode	Drive-by Mining	miner = new (CoinHive|CRLT)\.(Anonymous|User)\('
SourceCode	Drive-by Mining (Coinhive obf.)	\|miner\|User\|CoinHive\|\|
SourceCode	Drive-by Mining (coinhive obf.)	%3D%43%6F%69%6E%48%69%76%65%2E%41%6E%6F%6E%79%6D%6F%75%73%2
SourceCode	Encoded wasm (possible web miner)	IE1vZHVsZT17fTtNb2R1bGVbIndhc21CaW5hcnkiXT
IP	CoinIMP Miner	212\.32\.255\.(3|4|5|6|7|9|10|11|12|13|93)

## Social Engineering / Tech Support Scams
URI	FakeUpdates (Redirection)	\/([a-z0-9]{70}|s_code\.js)\?cid=[0-9]{3}&(session=[a-z0-9]{32}|v=[a-z0-9]{20})	http://www.broadanalysis.com/2018/03/03/fake-flash-and-chrome-updates-lead-to-ramnit-trojan/
URI	FakeUpdates (Template)	^http:\/\/(?!www)[^.]([a-z0-9-]+\.){2}[a-z]{2,7}\/(browserfiles\/((css.css$)|(img|logo|fonts|favicon)\/)|topics\/index\.php\?n=[0-9]{6}&o=)
URI	FlashOffer	\/lp\/flash\/offer\.php$	https://traffic.moe/2018/03/15/index.html
URI	FakeAdobeFlash	^https?:\/\/[^\x3f]+\/(\x3f(dfgh=|pcl=|51tga=)|(zzz\x3f))[^\x3f]+(&cid=|&sid=)[^\n]+$|\x3f[^\x3f]+(..&cid=)?[^\x3f]+(&(sid|SUB_ID|sub|payout)=)[^\x3f]+(&v_id=)[^\x3f]+$	https://twitter.com/baberpervez2
URI	FakeBrowserUpdate	wibeee\.com\.ua|kompleks-ohoroni\.kiev\.ua|quoidevert\.com	https://blog.sucuri.net/2019/02/fake-browser-updates-push-ransomware-and-bank-malware.html
URI	FakeUpdates (DropBox)	^https\:\/\/dl\.dropboxusercontent\.com\/s\/[\w\d]{15}\/[^\x3f]+\.js\?dl\=1	https://twitter.com/baberpervez2
URI	TSS Browlock	\/((\?number=|(AT-|)TollFree(-|))((1-)?8[0-9]{2}-[0-9]{3}-[0-9]{4}|([0-9]{2}-){4}[0-9]{2}&)|\?a=[0-9]{4}&source=[0-9]{5}_[0-9]{5})$
URI	TSS_EDGE	ifr\.src = '\.\.\/useragent\.php';
URI	TSS Forced login	\.club\/newauth\/\w+\/auth.php$
SourceCode	Shoppers TSS Campaign	Your computer with the IP address <strong>182.74.27.50
SourceCode	TSS PartnerStroka Campaign	var stroka = "<tr><td valign
SourceCode	FakeBrowserUpdate	var link_to_file = 'http:"|Histats.start', '1,4214393|Histats.start', '1,4209412
SourceCode	FakeFlash	alert\("WARNING! Your Flash Player is out of date\. |src="http:\/\/byte\.wo\.tc\/js\/lib\/js\.js">
SourceCode	FakeUpdates Campaign (Hacked Site)	\(function\(\)\{var [a-z]=navigator\[[a-z]\("	https://blog.malwarebytes.com/threat-analysis/2018/04/fakeupdates-campaign-leverages-multiple-website-platforms/
SourceCode	FakeUpdates (JS download)	var filename = 'Chrome\.Update\.
SourceCode	TSS Browlock	\\nToll Free: \(888\) [0-9]{3}-[0-9]{4}(\\n){20}|if \([0-9]{1,3} == a\.keyCode( \|\| [0-9]{1,3} == a\.keyCode){9}\) return !1|Hard Drive [sS]afety [dD]elete (in )?[sS]tarting [iI]n <span
SourceCode	TK redirection	(<script>window.location.replace\("|u=)http:\/\/[a-z-]{3,20}\.tk\/index\/\?[0-9]{13}
SourceCode	TSS (forced login)	<iframe height="1" src="login.php|ifr\.src = 'https?:\/\/\w+\.club\/newauth\/\w+\/auth.php
SourceCode	TSS TFN	(\+1)?(-[0-9]{3}){2}-[0-9]{4}(\\n){30}
SourceCode	TSS redirection	function createCookie13123213\(e,o,r\)
SourceCode	TSS warning audio	(err|beep|alert|warning|Texts|assests\/eng)[0-9]?\.mp3" type="audio
Hash	TSS Browlock (audio)	0589be7715d2320e559eae6bd26f3528e97450c70293da2e1e8ce45f77f99ab1|fc59bbb18f923747b9cd3f3b23537ff09c5ad2fdfc1505a4800a3f269a234e65

## CC and other Stealers
SourceCode	cdn71 skimmer	\\x63\\x64\\x6E\\x30\\x30\\x30\\x30\\x30\\x30\\x31
SourceCode	Magecart (code)	\\x2C\\x62\\x75\\x74\\x74\\x6F\\x6E\\x2C\\x20\\x69\\x6E\\x70\\x75\\x74\\x2C\\x20\\x73\\x75\\x62\\x6D\\x69\\x74\\x2C	https://www.riskiq.com/blog/labs/magecart-ticketmaster-breach/
SourceCode	JS Sniffer	gas\.src=location\.protocol\+'\/\/|L2dhdGUucGhw"\)\+"\?image_id=	https://www.volexity.com/blog/2018/07/19/js-sniffer-e-commerce-data-theft-made-easy/
SourceCode	Web Skimmer (Magento)	GetCCInfo: function\(\) \{
SourceCode	Web Skimmer (Angular)	\};Angular(\['|\.)ready('\])?\(\)|Angular\.algularToken|\}\}return null;\},'register':function\(_
SourceCode	Web Skimmer (Fake GetSiteControl)	break;\n\}(\n)?\}\)\(window, document, '_gscq
SourceCode	Web Skimmer (Radix)	0w0w0w0w0w0w0w0w0w0w0
SourceCode	Web Skimmer	if ?\(new RegExp\(_0x[a-z0-9]{2,8}\('0x0'
URI	JS Sniffer	=WyJ1cmwl

## Phishing
SourceCode	Chalbhai Phish	name=chalbhai id=chalbhai method=post

## C2 Callbacks
URI	Baldr C2	\/baldr\/gate\.php\?hwid=
URI	FakeUpdates C2 (Callback and payload)	^http(s|):\/\/(?![a-z]+\.)([a-z0-9]+\.){3}[a-z]{2,7}\/pixel\.gif($|\?ss&ss)
URI	GandCrab C2	kakaocorp\.link

## Misc
URI	Vidar Library	(\.ac)?\.ug\/\w+\.dll($|\?ddosprotected)
SourceCode	Vidar Profile	(1|0|,){20}250,(Default|Desktop);%DESKTOP%\\;\*\.txt

##############################################################################
## Regexes for data extraction
##############################################################################
## These new regexes have a different syntax, specifically for extracting
## between 2 anchors (skimmers and miners). Supports simple strings, Base64 
## or Hex encoded strings. Phone numbers use one regex for exact match
## Usage: 
## Miners: [Extract-Miner] TAB [BeginsWith] TAB [EndsWith]
## Skimmers: [Extract-Skimmer] TAB [BeginsWith] TAB [EndsWith]
## Phone numbers: [Extract-Phone] TAB [PhoneRegex]
## Please remember NOT to edit this file but use CustomRegexes.txt if you want
## to add new ones!!!
# Skimmers
Extract-Skimmer	Gate: \"	\"
Extract-Skimmer	\"//	\"\)
Extract-Skimmer	,a.src=atob\(\"	\"\)\+\"\?
Extract-Skimmer	\\x68\\x74\\x74\\x70\\x73\\x3A\\x2F\\x2F	\",\"
# Miners
Extract-Miner	new CoinHive.Anonymous\('	'
Extract-Miner	new CRLT.Anonymous\('	'
# Phone numbers
Extract-Phone	1-\d\d\d-\d\d\d-\d\d\d\d

##############################################################################
########################### END OF REGEXES ###################################
##############################################################################